<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD MAPPER 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="DGroupMapper">

	<insert id="create">
		INSERT INTO DGroup (
			dgroupOwner, dgroupType, dgroupMax, dgroupName, dgroupDate, dgroupDetail, dgroupOwnerName
		) VALUES (
			#{dgroupOwner}, #{dgroupType}, #{dgroupMax}, #{dgroupName}, #{dgroupDate}, #{dgroupDetail}, #{dgroupOwnerName}
		)
	</insert>
	
	<select id="readById" resultType="com.project.dnflol.DTO.DGroupDTO">
		SELECT dgroupId, dgroupOwner, dgroupType, dgroupMax, dgroupName, dgroupDate, dgroupDetail, dgroupOwnerName
		FROM DGroup
		WHERE dgroupId = #{dgroupId}
		ORDER BY dgroupDate DESC
	</select>
	
	<select id="readDgroupId" resultType="Integer">
		SELECT dgroupId
		FROM DGroup
		WHERE dgroupOwner = #{dgroupOwner} AND dgroupType = #{dgroupType} AND dgroupName = #{dgroupName} AND dgroupDate = #{dgroupDate}
	</select>
	
	
	<select id="readAllByOwnerName" resultType="com.project.dnflol.DTO.DGroupDTO">
	<![CDATA[
		SELECT dgroupId, dgroupOwnerName, dgrouptype, dgroupMax, dgroupName, dgroupDate, dgroupDetail, dgroupOwnerName
		FROM DGroup
		WHERE dgroupOwnerName LIKE CONCAT('%',#{ownerName},'%')
		ORDER BY dgroupDate DESC
	]]>
	</select>
	
	<select id="readAllByDetail" resultType="com.project.dnflol.DTO.DGroupDTO">
	<![CDATA[
		SELECT dgroupId, dgroupOwner, dgroupType, dgroupMax, dgroupName, dgroupDate, dgroupDetail, dgroupOwnerName
		FROM DGroup
		WHERE dgroupDetail LIKE CONCAT('%',#{dgroupDetail},'%')
		ORDER BY dgroupDate DESC
	]]>
	</select>
	
	<select id="readAllByGroupName" resultType="com.project.dnflol.DTO.DGroupDTO">
	<![CDATA[
		SELECT dgroupId, dgroupOwner, dgroupType, dgroupMax, dgroupName, dgroupDate, dgroupDetail, dgroupOwnerName
		FROM DGroup
		WHERE dgroupName Like CONCAT('%',#{dgroupName},'%')
		ORDER BY dgroupDate DESC
	]]>
	</select>
	
	<select id="readAllByUId" resultType="com.project.dnflol.DTO.DGroupDTO">
	<![CDATA[
		SELECT dgroupId, dgroupOwner, dgroupType, dgroupMax, dgroupName, dgroupDate, dgroupDetail, dgroupOwnerName
		FROM DGroup, DChar
		WHERE DGroup.dgroupOwnerName = DChar.dcharName AND DChar.uid = #{uid}
	]]>
	</select>
	
	<select id="readLimitList" resultType="com.project.dnflol.DTO.DGroupDTO">
	<![CDATA[
		SELECT dgroupId, dgroupOwner, dgroupType, dgroupMax, dgroupName, dgroupDate, dgroupDetail, dgroupOwnerName
		FROM DGroup
		ORDER BY dgroupDate DESC
		LIMIT #{min}, #{max}
	]]>
	</select>
	
	<select id="readMaxCount" resultType="int">
		SELECT Count(*)
		FROM DGroup
	</select>
	
	<update id="updateType">
		UPDATE DGroup
		SET dgroupType = #{dgroupType}, dgroupMax = #{dgroupMax}
		WHERE dgroupId = #{dgroupId}
	</update>
	
	<delete id="deleteById">
		DELETE FROM DGroup
		WHERE dgroupId = #{dgroupId}
	</delete>

</mapper>